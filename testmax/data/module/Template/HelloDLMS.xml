<page name="HelloDLMS" class="com.testmax.handler.ApiHandler">
  <action name="MockFrame" type="API" description="Mock DLMS frame + simple assertions"
    setglobal="yes">

    <!-- Krok 1: uložím mock hodnoty do proměnných -->
    <validator name="Step-1: Set mock variables">
      <assert name="Set frame" descriptor="VARCHAR"
        output="frame" value="C0017E1009000102AABBCCDD" operator="Set" />

      <assert name="Set obis" descriptor="VARCHAR"
        output="obis" value="1-0:1.8.0" operator="Set" />

      <assert name="Set val" descriptor="VARCHAR"
        output="val" value="12345" operator="Set" />

      <assert name="Set unit" descriptor="VARCHAR"
        output="unit" value="Wh" operator="Set" />
    </validator>

    <!-- Krok 2: ověřím, že proměnné mají očekávané hodnoty -->
    <validator name="Step-2: Validate fields">
      <assert name="OBIS present" descriptor="VARCHAR" output="obis" value="1-0:1.8.0"
        operator="Equals" />
      <assert name="Value present" descriptor="VARCHAR" output="val" value="12345" operator="Equals" />
      <assert name="Unit present" descriptor="VARCHAR" output="unit" value="Wh" operator="Equals" />
    </validator>


    <!-- Volitelně maličký JUnit smoke -->
    <validator name="Step-3: Tiny JUnit smoke">
      <junit name="Test com.testmax.samples.custom">
        <testPackage name="com.testmax.samples.custom">
          <testClass name="AlwaysPass" />
        </testPackage>
      </junit>
    </validator>

  </action>
</page>